/*!
 * ----------------------------------------------------------
 *  HTML TEXT EDITOR PLUGIN 1.0.0
 * ----------------------------------------------------------
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 *
 * REQUIRES:
 * ==========================================================
 * [1]. https://github.com/tovic/simple-text-editor-library
 * [2]. https://fortawesome.github.io/Font-Awesome/icons
 * ==========================================================
 * ----------------------------------------------------------
 *
 */

;var HTE=function(e,t){function n(e,t){e=e||{};for(var i in t)e[i]="object"==typeof t[i]?n(e[i],t[i]):t[i];return e}var i=this,l=window,r=document,o=new Editor(e),a={tabSize:"    ",toolbar:!0,shortcut:!1,toolbarClass:"editor-toolbar",toolbarPosition:"before",iconClassPrefix:"fa fa-",buttons:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel",bold:"Bold",italic:"Italic",underline:"Underline",strike:"Strike",code:"Code",paragraph:"Paragraph",quote:"Quote",heading:"H1 \u2013 H6",link:"Link",image:"Image",ol:"Ordered List",ul:"Unordered List",rule:"Horizontal Rule",undo:"Undo",redo:"Redo"},prompt:{link_title:"link title goes here...",link_title_title:"Link Title",link_url:"http://",link_url_title:"Link URL",image_url:"http://",image_url_title:"Image URL"},placeholder:{heading_text:"Heading",link_text:"link text",list_ul_text:"List Item",list_ol_text:"List Item",image_alt:"Image"},keydown:function(){},click:function(){},ready:function(){}},c=r.createElement("div"),u=r.createElement("div");i.modal=function(e,t){e=e||"modal";var n=r.body;c.className="custom-modal-overlay custom-"+e+"-overlay",u.className="custom-modal custom-"+e,u.innerHTML='<div class="custom-modal-header custom-'+e+'-header"></div><div class="custom-modal-content custom-'+e+'-content"></div><div class="custom-modal-action custom-'+e+'-action"></div>',n.appendChild(c),n.appendChild(u),"function"==typeof t&&t(c,u)},i.close=function(e){if(c&&r.body.removeChild(c),u&&r.body.removeChild(u),"undefined"!=typeof e&&e===!0){var t=o.selection();o.select(t.start,t.end)}},i.prompt=function(e,t,n,l){i.modal("prompt",function(o,a){var c=function(e){"function"==typeof l?(i.close(),l(e)):i.close(!0)},u=r.createElement("input");u.type="text",u.value=t,u.onkeyup=function(e){n?13==e.keyCode&&""!==this.value&&this.value!==t&&c(this.value):13==e.keyCode&&c(this.value==t?"":this.value)};var d=r.createElement("button");d.innerHTML=s.buttons.ok,d.onclick=function(){n?""!==u.value&&u.value!==t&&c(u.value):c(u.value==t?"":u.value)};var f=r.createElement("button");f.innerHTML=s.buttons.cancel,f.onclick=function(){i.close(!0)},a.children[0].innerHTML=e?e:"",a.children[1].appendChild(u),a.children[2].appendChild(d),a.children[2].appendChild(r.createTextNode(" ")),a.children[2].appendChild(f),u.select()})},i.alert=function(e,t,n){i.modal("alert",function(l,o){var a=r.createElement("button");a.innerHTML=s.buttons.ok,a.onclick=function(){"function"==typeof n?(i.close(),n()):i.close(!0)},o.children[0].innerHTML=e?e:"",o.children[1].innerHTML=t?t:"",o.children[2].appendChild(a)})},i.confirm=function(e,t,n){i.modal("confirm",function(l,o){var a=r.createElement("button");a.innerHTML=s.buttons.ok,a.onclick=function(){"undefined"==typeof n?i.close(!0):"function"==typeof n.OK?(i.close(),n.OK()):i.close(!0)};var c=r.createElement("button");c.innerHTML=s.buttons.cancel,c.onclick=function(){return"undefined"==typeof n?i.close(!0):"function"==typeof n.CANCEL?(i.close(),n.CANCEL()):i.close(!0),!1},o.children[0].innerHTML=e?e:"",o.children[1].innerHTML=t?t:"",o.children[2].appendChild(a),o.children[2].appendChild(r.createTextNode(" ")),o.children[2].appendChild(c)})};var s=n(a,t),d=r.createElement("span");s.toolbar&&(d.className=s.toolbarClass,o.area.parentNode.insertBefore(d,"before"==s.toolbarPosition?o.area:null)),i.button=function(e,t){if(t.title!==!1){var n=r.createElement("a");n.href="#"+e,n.setAttribute("tabindex",-1),n.innerHTML='<i class="'+s.iconClassPrefix+e+'"></i>',n.onclick=function(n){return t.click(n,i),s.click(n,i,e),!1},t.title&&(n.title=t.title),t.position?d.insertBefore(n,d.children[t.position-1]):d.appendChild(n)}},o.toggle=function(e,t,n){var i=o.selection();if(i.before.slice(-e.length)!=e&&i.after.slice(0,t.length)!=t)o.wrap(e,t);else{var l=i.before.slice(-e.length)==e?i.before.substring(0,i.before.length-e.length):i.before,r=i.after.substring(0,t.length)==t?i.after.substring(t.length):i.after;o.area.value=l+i.value+r,o.select(l.length,l.length+i.value.length,function(){o.updateHistory()})}"function"==typeof n&&n()};var f=0,p=a.buttons,h={bold:{title:p.bold,click:function(){o.toggle("<strong>","</strong>")}},italic:{title:p.italic,click:function(){o.toggle("<em>","</em>")}},underline:{title:p.underline,click:function(){o.toggle("<u>","</u>")}},strikethrough:{title:p.strike,click:function(){var e=new Date,t=e.getDate(),n=e.getMonth()+1,i=e.getFullYear();10>t&&(t="0"+t),10>n&&(n="0"+n),o.toggle('<del datetime="'+i+"-"+n+"-"+t+'">',"</del>")}},code:{title:p.code,click:function(){var e=o.selection().value;-1!==e.indexOf("\n")?o.toggle("<pre><code>","</code></pre>"):o.toggle("<code>","</code>")}},paragraph:{title:p.paragraph,click:function(){var e=o.selection().value;-1!==e.indexOf("\n")?(o.replace(/^/,"<p>"),o.replace(/$/,"</p>"),o.replace(/\n/g,"</p>\n<p>"),o.replace(/<p><\/p>/g,"")):o.toggle("<p>","</p>")}},"quote-right":{title:p.quote,click:function(){o.toggle("<blockquote>","</blockquote>")}},header:{title:p.heading,click:function(){var e=o.selection();if(f=6>f?f+1:0,e.value.length>0)if(e.before.match(/<h[1-6]>$/)){var t=e.before.replace(/<h[1-6]>$/,""),n=e.value.replace(/^<h[1-6]>|<\/h[1-6]>$/g,""),i=e.after.replace(/^<\/h[1-6]>/,"");o.area.value=t+(f>0?"<h"+f+">":"")+n+(f>0?"</h"+f+">":"")+i,o.select(t.length+(f>0?4:0),t.length+(f>0?4:0)+n.length,function(){o.updateHistory()})}else o.wrap(f>0?"<h"+f+">":"",f>0?"</h"+f+">":"",function(){o.replace(/^<h[1-6]>|<\/h[1-6]>$/g,"")});else{var l=s.placeholder.heading_text;f=1,o.insert("<h"+f+">"+l+"</h"+f+">",function(){e=o.selection().end,o.select(e-l.length-5,e-5,function(){o.updateHistory()})})}}},link:{title:p.link,click:function(){var e,t,n=o.selection(),l=s.placeholder.link_text;i.prompt(s.prompt.link_title_title,s.prompt.link_title,!1,function(r){e=r,i.prompt(s.prompt.link_url_title,s.prompt.link_url,!0,function(i){t=i,0===n.value.length?o.insert('<a href="'+t+'"'+(""!==e?' title="'+e+'"':"")+">"+l+"</a>",function(){var e=o.selection().end;o.select(e-l.length-4,e-4,function(){o.updateHistory()})}):o.wrap('<a href="'+t+'"'+(""!==e?' title="'+e+'"':"")+">","</a>")})})}},image:{title:p.image,click:function(){i.prompt(s.prompt.image_url_title,s.prompt.image_url,!0,function(e){var t=decodeURIComponent(e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")).replace(/[\-\+\.\_]+/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()});t=-1===t.indexOf("/")&&-1!==e.indexOf(".")?t:s.placeholder.image_alt,o.insert('\n<img alt="'+t+'" src="'+e+'">\n')})}},"list-ol":{title:p.ol,click:function(){var e=o.selection(),t=s.placeholder.list_ol_text;e.value.length>0?e.value==t?o.select(e.start,e.end):o.insert("<ol>\n"+s.tabSize+"<li>"+e.value.replace(/\n/g,"</li>\n"+s.tabSize+"<li>").replace(new RegExp("\n("+s.tabSize+")?<li></li>\n","g"),"\n</ol>\n\n<ol>\n")+"</li>\n</ol>"):o.insert("<ol>\n"+s.tabSize+"<li>"+t+"</li>\n</ol>",function(){o.select(e.start+s.tabSize.length+9,e.start+s.tabSize.length+9+t.length,function(){o.updateHistory()})})}},"list-ul":{title:p.ul,click:function(){var e=o.selection(),t=s.placeholder.list_ul_text;e.value.length>0?e.value==t?o.select(e.start,e.end):o.insert("<ul>\n"+s.tabSize+"<li>"+e.value.replace(/\n/g,"</li>\n"+s.tabSize+"<li>").replace(new RegExp("\n("+s.tabSize+")?<li></li>\n","g"),"\n</ul>\n\n<ul>\n")+"</li>\n</ul>"):o.insert("<ul>\n"+s.tabSize+"<li>"+t+"</li>\n</ul>",function(){o.select(e.start+s.tabSize.length+9,e.start+s.tabSize.length+9+t.length,function(){o.updateHistory()})})}},"ellipsis-h":{title:p.rule,click:function(){o.insert("\n<hr>\n")}},"rotate-left":{title:p.undo,click:function(){o.undo()}},"rotate-right":{title:p.redo,click:function(){o.redo()}}};for(var g in h)i.button(g,h[g]);var m=function(e,t){return o.insert(e,function(){o.select(t.end+1,t.end+1)}),!1};o.area.onkeydown=function(e){var t=o.selection(),n=e.keyCode,r=e.ctrlKey,c=e.shiftKey,u=e.altKey;l.setTimeout(function(){s.keydown(e,i)},10);var d=t.before,f=t.after[0];if(-1!==d.indexOf("(")&&c&&48==n&&")"==f&&"\\"!=d.slice(-1)||-1!==d.indexOf("{")&&c&&221==n&&"}"==f&&"\\"!=d.slice(-1)||-1!==d.indexOf("[")&&221==n&&"]"==f&&"\\"!=d.slice(-1)||-1!==d.indexOf('"')&&c&&222==n&&'"'==f&&"\\"!=d.slice(-1)||-1!==d.indexOf("'")&&!c&&222==n&&"'"==f&&"\\"!=d.slice(-1)||-1!==d.indexOf("`")&&!c&&192==n&&"`"==f&&"\\"!=d.slice(-1)||-1!==d.indexOf("<")&&c&&190==n&&">"==f&&"\\"!=d.slice(-1))return o.select(t.end+1,t.end+1),!1;if(c&&57==n)return m("("+t.value+")",t);if(c&&219==n)return m("{"+t.value+"}",t);if(!c&&219==n)return m("["+t.value+"]",t);if(c&&222==n)return m('"'+t.value+'"',t);if(!c&&222==n)return m("'"+t.value+"'",t);if(!c&&192==n)return m("`"+t.value+"`",t);if(c&&188==n)return m("<"+t.value+">",t);if(c&&9==n)return o.outdent(s.tabSize),!1;if(9==n)return o.indent(s.tabSize),!1;if(r&&90==n)return o.undo(),!1;if(r&&89==n||r&&82==n)return o.redo(),!1;if(a.shortcut){if(r&&66==n)return h.bold.click(),!1;if(r&&73==n)return h.italic.click(),!1;if(r&&81==n)return h["quote-right"].click(),!1;if(u&&81==n)return c?o.toggle("&ldquo;","&rdquo;"):o.toggle("&lsquo;","&rsquo;"),!1;if(r&&72==n)return h.header.click(),!1;if(r&&76==n)return h.link.click(),!1;if(r&&71==n)return h.image.click(),!1}if(13==n){if(r)return h.paragraph.click(),!1;if(c)return o.insert("<br>\n"),!1;if(t.before.match(/<\/li>$/))return o.insert("\n"+s.tabSize+"<li></li>",function(){o.select(t.end+s.tabSize.length+5,t.end+s.tabSize.length+5,function(){o.updateHistory()})}),!1;if(t.after.match(/^<\/li>/))return o.insert("</li>\n"+s.tabSize+"<li>"),!1;var p=new RegExp("(^|\n)(("+s.tabSize+")+)(.*?)$").exec(t.before),g=p?p[2]:"";return t.before.match(/[\(\{\[]$/)&&t.after.match(/^[\]\}\)]/)||t.before.match(/<[^\/]*?>$/)&&t.after.match(/^<\//)?(o.insert("\n"+g+s.tabSize+"\n"+g,function(){o.select(t.start+g.length+s.tabSize.length+1,t.start+g.length+s.tabSize.length+1,function(){o.updateHistory()})}),!1):(o.insert("\n"+g),!1)}if(8==n&&0===t.value.length){if(t.before.match(new RegExp(s.tabSize+"$")))return o.outdent(s.tabSize),!1;switch(t.before.slice(-1)){case"(":return o.toggle("(",")"),!1;case"{":return o.toggle("{","}"),!1;case"[":return o.toggle("[","]"),!1;case'"':return o.toggle('"','"'),!1;case"'":return o.toggle("'","'"),!1;case"<":return o.toggle("<",">"),!1;case"`":return o.toggle("`","`"),!1}}if(39==n&&t.after.match(/^<\/.*?>/)){var b=t.end+t.after.indexOf(">");o.select(b,b,function(){o.updateHistory()})}o.updateHistory()},s.ready(i),i.grip=o};