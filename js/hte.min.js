/*!
 * ----------------------------------------------------------
 *  HTML TEXT EDITOR PLUGIN 1.0.2
 * ----------------------------------------------------------
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 *
 * REQUIRES:
 * ==========================================================
 * [1]. https://github.com/tovic/simple-text-editor-library
 * [2]. https://fortawesome.github.io/Font-Awesome/icons
 * ==========================================================
 * ----------------------------------------------------------
 *
 */

var HTE=function(e,t){function n(e,t){e=e||{};for(var l in t)e[l]="object"==typeof t[l]?n(e[l],t[l]):t[l];return e}function l(e,t){var n=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),l=0;return l=r.defaultView&&r.defaultView.getComputedStyle?r.defaultView.getComputedStyle(e,null).getPropertyValue(t):e.style[n]}var i=this,o=window,r=document,c=new Editor(e),a={tabSize:"    ",toolbar:!0,shortcut:!1,toolbarClass:"editor-toolbar",toolbarPosition:"before",buttonClassPrefix:"editor-toolbar-button editor-toolbar-button-",iconClassPrefix:"fa fa-",emptyElementSuffix:">",autoEncodeHTML:!0,buttons:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel",open:"Open",close:"Close",bold:"Bold",italic:"Italic",underline:"Underline",strike:"Strike",superscript:"Superscript",subscript:"Subscript",code:"Code",paragraph:"Paragraph",quote:"Quote",heading:"H1 \u2013 H6",link:"Link",image:"Image",ol:"Ordered List",ul:"Unordered List",rule:"Horizontal Rule",undo:"Undo",redo:"Redo"},prompt:{link_title:"link title goes here\u2026",link_title_title:"Link Title",link_url:"http://",link_url_title:"Link URL",image_url:"http://",image_url_title:"Image URL"},placeholder:{heading_text:"Heading",link_text:"link text",list_ul_text:"List Item",list_ol_text:"List Item",image_alt:"Image"},keydown:function(){},click:function(){},ready:function(){}},u=r.createElement("div"),s=r.createElement("div");i.modal=function(e,t){e=e||"modal";var n=r.body,l=n.scrollTop||r.documentElement.scrollTop;u.className="custom-modal-overlay custom-modal-"+e+"-overlay",u.onclick=function(){i.close(!0)},s.className="custom-modal custom-modal-"+e,s.innerHTML='<div class="custom-modal-header custom-modal-'+e+'-header"></div><div class="custom-modal-content custom-modal-'+e+'-content"></div><div class="custom-modal-action custom-modal-'+e+'-action"></div>',s.style.visibility="hidden",n.appendChild(u),n.appendChild(s),o.setTimeout(function(){var e=s.offsetWidth,t=s.offsetHeight;s.style.position="absolute",s.style.top="50%",s.style.left="50%",s.style.zIndex="9999",s.style.marginTop=l-t/2+"px",s.style.marginLeft="-"+e/2+"px",s.style.visibility="",s.offsetTop<0&&(s.style.top=0,s.style.marginTop=0),s.offsetLeft<0&&(s.style.left=0,s.style.marginLeft=0)},10),"function"==typeof t&&t(u,s)},i.close=function(e){if(u&&r.body.removeChild(u),s&&r.body.removeChild(s),void 0!==e&&e===!0){var t=c.selection();c.select(t.start,t.end)}},i.prompt=function(e,t,n,l){i.modal("prompt",function(c,a){var u=function(e){"function"==typeof l?(i.close(),l(e)):i.close(!0)},s=r.createElement("input");s.type="text",s.value=t,s.onkeyup=function(e){n?13==e.keyCode&&""!==this.value&&this.value!==t&&u(this.value):13==e.keyCode&&u(this.value==t?"":this.value)};var d=r.createElement("button");d.innerHTML=f.buttons.ok,d.onclick=function(){n?""!==s.value&&s.value!==t&&u(s.value):u(s.value==t?"":s.value)};var p=r.createElement("button");p.innerHTML=f.buttons.cancel,p.onclick=function(){i.close(!0)},a.children[0].innerHTML=e?e:"",a.children[1].appendChild(s),a.children[2].appendChild(d),a.children[2].appendChild(r.createTextNode(" ")),a.children[2].appendChild(p),o.setTimeout(function(){s.select()},10)})},i.alert=function(e,t,n){i.modal("alert",function(l,o){var c=r.createElement("button");c.innerHTML=f.buttons.ok,c.onclick=function(){"function"==typeof n?(i.close(),n()):i.close(!0)},o.children[0].innerHTML=e?e:"",o.children[1].innerHTML=t?t:"",o.children[2].appendChild(c)})},i.confirm=function(e,t,n){i.modal("confirm",function(l,o){var c=r.createElement("button");c.innerHTML=f.buttons.ok,c.onclick=function(){void 0===n?i.close(!0):"function"==typeof n.OK?(i.close(),n.OK()):i.close(!0)};var a=r.createElement("button");a.innerHTML=f.buttons.cancel,a.onclick=function(){return void 0===n?i.close(!0):"function"==typeof n.CANCEL?(i.close(),n.CANCEL()):i.close(!0),!1},o.children[0].innerHTML=e?e:"",o.children[1].innerHTML=t?t:"",o.children[2].appendChild(c),o.children[2].appendChild(r.createTextNode(" ")),o.children[2].appendChild(a)})};var f=n(a,t),d=r.createElement("span");f.toolbar&&(d.className=f.toolbarClass,c.area.parentNode.insertBefore(d,"before"==f.toolbarPosition?c.area:null)),i.button=function(e,t){if(t.title!==!1){var n=r.createElement("a");n.className=f.buttonClassPrefix+e,n.href="#"+e.replace(" ",":").replace(/[^a-z0-9\:]/gi,"-").replace(/-+/g,"-").replace(/^-+|-+$/,""),n.setAttribute("tabindex",-1),n.innerHTML='<i class="'+f.iconClassPrefix+e+'"></i>',n.onclick=function(e){return t.click(e,i),f.click(e,i,this.hash.replace("#","")),!1},t.title&&(n.title=t.title),t.position?d.insertBefore(n,d.children[t.position-1]):d.appendChild(n)}},c.toggle=function(e,t,n){var l=c.selection();if(l.before.slice(-e.length)!=e&&l.after.slice(0,t.length)!=t)c.wrap(e,t);else{var i=l.before.slice(-e.length)==e?l.before.substring(0,l.before.length-e.length):l.before,o=l.after.substring(0,t.length)==t?l.after.substring(t.length):l.after;c.area.value=i+l.value+o,c.select(i.length,i.length+l.value.length,function(){c.updateHistory()})}"function"==typeof n&&n()};var p=0,g=f.buttons,h={bold:{title:g.bold,click:function(){c.toggle("<strong>","</strong>")}},italic:{title:g.italic,click:function(){c.toggle("<em>","</em>")}},underline:{title:g.underline,click:function(){c.toggle("<u>","</u>")}},strikethrough:{title:g.strike,click:function(){var e=new Date,t=e.getDate(),n=e.getMonth()+1,l=e.getFullYear();10>t&&(t="0"+t),10>n&&(n="0"+n),c.toggle('<del datetime="'+l+"-"+n+"-"+t+'">',"</del>")}},code:{title:g.code,click:function(){var e=c.selection().value,t=-1===e.indexOf("\n"),n=t?"<code>":"<pre><code>",l=t?"</code>":"</code></pre>";if(e.length>0){var i=c.selection(),o=i.before,r=i.after,a=i.value;o.match(/(<pre(>| .*?>))?<code(>| .*?>)$/)&&r.match(/^<\/code>(<\/pre>)?/)?(o=o.replace(/(<pre(>| .*?>))?<code(>| .*?>)$/,""),r=r.replace(/^<\/code>(<\/pre>)?/,""),f.autoEncodeHTML&&(a=a.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")),c.area.value=o+a+r,c.select(o.length,o.length+a.length,function(){c.updateHistory()})):(f.autoEncodeHTML&&(a=a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),c.area.value=o+n+a+l+r,c.select(o.length+n.length,o.length+a.length+n.length,function(){c.updateHistory()}))}else c.toggle(n,l)}},paragraph:{title:g.paragraph,click:function(){var e=c.selection().value;-1!==e.indexOf("\n")?/^<p>|<\/p>$/.test(e)?c.replace(/<p>([\s\S]*?)<\/p>/g,"$1"):(c.replace(/^/,"<p>"),c.replace(/$/,"</p>"),c.replace(/\n/g,"</p>\n<p>"),c.replace(/<p><\/p>/g,""),c.replace(/<p><p>/g,"<p>"),c.replace(/<\/p><\/p>/g,"</p>")):c.toggle("<p>","</p>")}},"quote-right":{title:g.quote,click:function(){c.toggle("<blockquote>","</blockquote>")}},header:{title:g.heading,click:function(){var e=c.selection(),t=/<(?:h[1-6]|p)(>| .*?>)$/.exec(e.before);if(t=t?t[1]:">",p=6>p?p+1:0,e.value.length>0)if(e.before.match(/<(?:h[1-6]|p)(>| .*?>)$/)){var n=e.before.replace(/<(?:h[1-6]|p)(>| .*?>)$/g,""),l=e.value.replace(/^<(?:h[1-6]|p)(>| .*?>)|<\/(?:h[1-6]|p)>$/g,""),i=e.after.replace(/^<\/(?:h[1-6]|p)>/g,"");c.area.value=n+(p>0?"<h"+p+t:"<p"+t)+l+(p>0?"</h"+p+">":"</p>")+i,c.select(n.length+(p>0?t.length+3:t.length+2),n.length+(p>0?t.length+3:t.length+2)+l.length,function(){c.updateHistory()})}else c.wrap(p>0?"<h"+p+t:"<p"+t,p>0?"</h"+p+">":"</p>",function(){c.replace(/^<(?:h[1-6]|p)(>| .*?>)|<\/(?:h[1-6]|p)>$/g,"")});else{var o=f.placeholder.heading_text;p=1,c.insert("<h"+p+">"+o+"</h"+p+">",function(){e=c.selection().end,c.select(e-o.length-5,e-5,function(){c.updateHistory()})})}}},link:{title:g.link,click:function(){var e,t,n=c.selection(),l=f.placeholder.link_text;i.prompt(f.prompt.link_title_title,f.prompt.link_title,!1,function(o){e=o,i.prompt(f.prompt.link_url_title,f.prompt.link_url,!0,function(i){t=i,0===n.value.length?c.insert('<a href="'+t+'"'+(""!==e?' title="'+e+'"':"")+">"+l+"</a>",function(){var e=c.selection().end;c.select(e-l.length-4,e-4,function(){c.updateHistory()})}):c.wrap('<a href="'+t+'"'+(""!==e?' title="'+e+'"':"")+">","</a>")})})}},image:{title:g.image,click:function(){i.prompt(f.prompt.image_url_title,f.prompt.image_url,!0,function(e){var t=decodeURIComponent(e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")).replace(/[-+._]+/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()});t=-1===t.indexOf("/")&&-1!==e.indexOf(".")?t:f.placeholder.image_alt,c.insert('\n<img alt="'+t+'" src="'+e+'"'+f.emptyElementSuffix+"\n")})}},"list-ol":{title:g.ol,click:function(){var e=c.selection(),t=f.placeholder.list_ol_text;e.value.length>0?e.value==t?c.select(e.start,e.end):c.insert("<ol>\n"+f.tabSize+"<li>"+e.value.replace(/\n/g,"</li>\n"+f.tabSize+"<li>").replace(RegExp("\n("+f.tabSize+")?<li></li>\n","g"),"\n</ol>\n\n<ol>\n")+"</li>\n</ol>"):c.insert("<ol>\n"+f.tabSize+"<li>"+t+"</li>\n</ol>",function(){c.select(e.start+f.tabSize.length+9,e.start+f.tabSize.length+9+t.length,function(){c.updateHistory()})})}},"list-ul":{title:g.ul,click:function(){var e=c.selection(),t=f.placeholder.list_ul_text;e.value.length>0?e.value==t?c.select(e.start,e.end):c.insert("<ul>\n"+f.tabSize+"<li>"+e.value.replace(/\n/g,"</li>\n"+f.tabSize+"<li>").replace(RegExp("\n("+f.tabSize+")?<li></li>\n","g"),"\n</ul>\n\n<ul>\n")+"</li>\n</ul>"):c.insert("<ul>\n"+f.tabSize+"<li>"+t+"</li>\n</ul>",function(){c.select(e.start+f.tabSize.length+9,e.start+f.tabSize.length+9+t.length,function(){c.updateHistory()})})}},superscript:{title:g.superscript,click:function(){c.toggle("<sup>","</sup>")}},subscript:{title:g.subscript,click:function(){c.toggle("<sub>","</sub>")}},"ellipsis-h":{title:g.rule,click:function(){c.insert("\n<hr"+f.emptyElementSuffix+"\n")}},undo:{title:g.undo,click:function(){c.undo()}},repeat:{title:g.redo,click:function(){c.redo()}}};for(var m in h)i.button(m,h[m]);var v=function(e,t){return c.insert(e,function(){c.select(t.end+1,t.end+1)}),!1};c.area.onkeydown=function(e){var t=this,n=c.selection(),r=e.keyCode,a=e.ctrlKey,u=e.shiftKey,s=e.altKey,d=t.scrollTop+parseInt(l(t,"line-height"),10);o.setTimeout(function(){f.keydown(e,i)},10);var p=n.before,g=n.after[0];if(-1!==p.indexOf("(")&&u&&48==r&&")"==g&&"\\"!=p.slice(-1)||-1!==p.indexOf("{")&&u&&221==r&&"}"==g&&"\\"!=p.slice(-1)||-1!==p.indexOf("[")&&221==r&&"]"==g&&"\\"!=p.slice(-1)||-1!==p.indexOf('"')&&u&&222==r&&'"'==g&&"\\"!=p.slice(-1)||-1!==p.indexOf("'")&&!u&&222==r&&"'"==g&&"\\"!=p.slice(-1)||-1!==p.indexOf("`")&&!u&&192==r&&"`"==g&&"\\"!=p.slice(-1)||-1!==p.indexOf("<")&&u&&190==r&&">"==g&&"\\"!=p.slice(-1))return c.select(n.end+1,n.end+1),!1;if(u&&57==r)return v("("+n.value+")",n);if(u&&219==r)return v("{"+n.value+"}",n);if(!u&&219==r)return v("["+n.value+"]",n);if(u&&222==r)return v('"'+n.value+'"',n);if(!u&&222==r)return v("'"+n.value+"'",n);if(!u&&192==r)return v("`"+n.value+"`",n);if(u&&188==r)return v("<"+n.value+">",n);if(u&&9==r)return c.outdent(f.tabSize),!1;if(9==r)return c.indent(f.tabSize),!1;if(a&&90==r)return c.undo(),!1;if(a&&89==r||a&&82==r)return c.redo(),!1;if(f.shortcut){if(a&&66==r)return h.bold.click(),!1;if(a&&73==r)return h.italic.click(),!1;if(a&&81==r)return h["quote-right"].click(),!1;if(s&&81==r)return u?c.toggle("&ldquo;","&rdquo;"):c.toggle("&lsquo;","&rsquo;"),!1;if(a&&72==r)return h.header.click(),!1;if(a&&76==r)return h.link.click(),!1;if(a&&71==r)return h.image.click(),!1}if(13==r){if(a)return h.paragraph.click(),!1;if(u)return c.insert("<br"+f.emptyElementSuffix+"\n"),t.scrollTop=d,!1;if(n.before.match(/<\/li>$/))return c.insert("\n"+f.tabSize+"<li></li>",function(){c.select(n.end+f.tabSize.length+5,n.end+f.tabSize.length+5,function(){c.updateHistory()})}),t.scrollTop=d,!1;if(n.after.match(/^<\/li>/))return c.insert("</li>\n"+f.tabSize+"<li>"),t.scrollTop=d,!1;var m=RegExp("(^|\n)(("+f.tabSize+")+)(.*?)$").exec(n.before),b=m?m[2]:"";return n.before.match(/[\(\{\[]$/)&&n.after.match(/^[\]\}\)]/)||n.before.match(/<[^\/]*?>$/)&&n.after.match(/^<\//)?(c.insert("\n"+b+f.tabSize+"\n"+b,function(){c.select(n.start+b.length+f.tabSize.length+1,n.start+b.length+f.tabSize.length+1,function(){c.updateHistory()})}),t.scrollTop=d,!1):(c.insert("\n"+b),t.scrollTop=d,!1)}if(8==r&&0===n.value.length){if(n.before.match(RegExp(f.tabSize+"$")))return c.outdent(f.tabSize),!1;switch(n.before.slice(-1)){case"(":return c.toggle("(",")"),!1;case"{":return c.toggle("{","}"),!1;case"[":return c.toggle("[","]"),!1;case'"':return c.toggle('"','"'),!1;case"'":return c.toggle("'","'"),!1;case"<":return c.toggle("<",">"),!1;case"`":return c.toggle("`","`"),!1}}if(39==r&&n.after.match(/^<\/.*?>/)){var k=n.end+n.after.indexOf(">");c.select(k,k,function(){c.updateHistory()})}c.updateHistory()},f.ready(i),i.grip=c,i.grip.config=f};