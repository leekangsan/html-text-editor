/*!
 * ----------------------------------------------------------
 *  HTML TEXT EDITOR PLUGIN 1.0.1
 * ----------------------------------------------------------
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 *
 * REQUIRES:
 * ==========================================================
 * [1]. https://github.com/tovic/simple-text-editor-library
 * [2]. https://fortawesome.github.io/Font-Awesome/icons
 * ==========================================================
 * ----------------------------------------------------------
 *
 */

;var HTE=function(a,b){function j(a,b){a=a||{};for(var c in b)a[c]="object"==typeof b[c]?j(a[c],b[c]):b[c];return a}var c=this,d=window,e=document,f=new Editor(a),g={tabSize:"    ",toolbar:!0,shortcut:!1,toolbarClass:"editor-toolbar",toolbarPosition:"before",iconClassPrefix:"fa fa-",emptyElementSuffix:">",autoEncodeHTML:!0,buttons:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel",open:"Open",close:"Close",bold:"Bold",italic:"Italic",underline:"Underline",strike:"Strike",superscript:"Superscript",subscript:"Subscript",code:"Code",paragraph:"Paragraph",quote:"Quote",heading:"H1 \u2013 H6",link:"Link",image:"Image",ol:"Ordered List",ul:"Unordered List",rule:"Horizontal Rule",undo:"Undo",redo:"Redo"},prompt:{link_title:"link title goes here...",link_title_title:"Link Title",link_url:"http://",link_url_title:"Link URL",image_url:"http://",image_url_title:"Image URL"},placeholder:{heading_text:"Heading",link_text:"link text",list_ul_text:"List Item",list_ol_text:"List Item",image_alt:"Image"},keydown:function(){},click:function(){},ready:function(){}},h=e.createElement("div"),i=e.createElement("div");c.modal=function(a,b){a=a||"modal";var f=e.body;h.className="custom-modal-overlay custom-"+a+"-overlay",h.onclick=c.close,i.className="custom-modal custom-"+a,i.innerHTML='<div class="custom-modal-header custom-'+a+'-header"></div><div class="custom-modal-content custom-'+a+'-content"></div><div class="custom-modal-action custom-'+a+'-action"></div>',i.style.visibility="hidden",f.appendChild(h),f.appendChild(i),d.setTimeout(function(){var a=i.offsetWidth,b=i.offsetHeight;i.style.position="absolute",i.style.top="50%",i.style.left="50%",i.style.zIndex="9999",i.style.marginTop="-"+b/2+"px",i.style.marginLeft="-"+a/2+"px",i.style.visibility=""},10),"function"==typeof b&&b(h,i)},c.close=function(a){if(h&&e.body.removeChild(h),i&&e.body.removeChild(i),"undefined"!=typeof a&&a===!0){var b=f.selection();f.select(b.start,b.end)}},c.prompt=function(a,b,f,g){c.modal("prompt",function(h,i){var j=function(a){"function"==typeof g?(c.close(),g(a)):c.close(!0)},l=e.createElement("input");l.type="text",l.value=b,l.onkeyup=function(a){f?13==a.keyCode&&""!==this.value&&this.value!==b&&j(this.value):13==a.keyCode&&j(this.value==b?"":this.value)};var m=e.createElement("button");m.innerHTML=k.buttons.ok,m.onclick=function(){f?""!==l.value&&l.value!==b&&j(l.value):j(l.value==b?"":l.value)};var n=e.createElement("button");n.innerHTML=k.buttons.cancel,n.onclick=function(){c.close(!0)},i.children[0].innerHTML=a?a:"",i.children[1].appendChild(l),i.children[2].appendChild(m),i.children[2].appendChild(e.createTextNode(" ")),i.children[2].appendChild(n),d.setTimeout(function(){l.select()},10)})},c.alert=function(a,b,d){c.modal("alert",function(f,g){var h=e.createElement("button");h.innerHTML=k.buttons.ok,h.onclick=function(){"function"==typeof d?(c.close(),d()):c.close(!0)},g.children[0].innerHTML=a?a:"",g.children[1].innerHTML=b?b:"",g.children[2].appendChild(h)})},c.confirm=function(a,b,d){c.modal("confirm",function(f,g){var h=e.createElement("button");h.innerHTML=k.buttons.ok,h.onclick=function(){"undefined"==typeof d?c.close(!0):"function"==typeof d.OK?(c.close(),d.OK()):c.close(!0)};var i=e.createElement("button");i.innerHTML=k.buttons.cancel,i.onclick=function(){return"undefined"==typeof d?c.close(!0):"function"==typeof d.CANCEL?(c.close(),d.CANCEL()):c.close(!0),!1},g.children[0].innerHTML=a?a:"",g.children[1].innerHTML=b?b:"",g.children[2].appendChild(h),g.children[2].appendChild(e.createTextNode(" ")),g.children[2].appendChild(i)})};var k=j(g,b),l=e.createElement("span");k.toolbar&&(l.className=k.toolbarClass,f.area.parentNode.insertBefore(l,"before"==k.toolbarPosition?f.area:null)),c.button=function(a,b){if(b.title!==!1){var d=e.createElement("a");d.href="#"+a.replace(" ",":").replace(/[^a-z0-9\:]/gi,"-").replace(/-+/g,"-").replace(/^-+|-+$/,""),d.setAttribute("tabindex",-1),d.innerHTML='<i class="'+k.iconClassPrefix+a+'"></i>',d.onclick=function(a){return b.click(a,c),k.click(a,c,this.hash.replace("#","")),!1},b.title&&(d.title=b.title),b.position?l.insertBefore(d,l.children[b.position-1]):l.appendChild(d)}},f.toggle=function(a,b,c){var d=f.selection();if(d.before.slice(-a.length)!=a&&d.after.slice(0,b.length)!=b)f.wrap(a,b);else{var e=d.before.slice(-a.length)==a?d.before.substring(0,d.before.length-a.length):d.before,g=d.after.substring(0,b.length)==b?d.after.substring(b.length):d.after;f.area.value=e+d.value+g,f.select(e.length,e.length+d.value.length,function(){f.updateHistory()})}"function"==typeof c&&c()};var m=0,n=k.buttons,o={bold:{title:n.bold,click:function(){f.toggle("<strong>","</strong>")}},italic:{title:n.italic,click:function(){f.toggle("<em>","</em>")}},underline:{title:n.underline,click:function(){f.toggle("<u>","</u>")}},strikethrough:{title:n.strike,click:function(){var a=new Date,b=a.getDate(),c=a.getMonth()+1,d=a.getFullYear();10>b&&(b="0"+b),10>c&&(c="0"+c),f.toggle('<del datetime="'+d+"-"+c+"-"+b+'">',"</del>")}},code:{title:n.code,click:function(){var a=f.selection().value,b=-1===a.indexOf("\n"),c=b?"<code>":"<pre><code>",d=b?"</code>":"</code></pre>";if(a.length>0){var e=f.selection(),g=e.before,h=e.after,i=e.value;g.match(/(<pre(>| .*?>))?<code(>| .*?>)$/)&&h.match(/^<\/code>(<\/pre>)?/)?(g=g.replace(/(<pre(>| .*?>))?<code(>| .*?>)$/,""),h=h.replace(/^<\/code>(<\/pre>)?/,""),k.autoEncodeHTML&&(i=i.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")),f.area.value=g+i+h,f.select(g.length,g.length+i.length,function(){f.updateHistory()})):(k.autoEncodeHTML&&(i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),f.area.value=g+c+i+d+h,f.select(g.length+c.length,g.length+i.length+c.length,function(){f.updateHistory()}))}else f.toggle(c,d)}},paragraph:{title:n.paragraph,click:function(){var a=f.selection().value;-1!==a.indexOf("\n")?/^<p>|<\/p>$/.test(a)?f.replace(/<p>([\s\S]*?)<\/p>/g,"$1"):(f.replace(/^/,"<p>"),f.replace(/$/,"</p>"),f.replace(/\n/g,"</p>\n<p>"),f.replace(/<p><\/p>/g,""),f.replace(/<p><p>/g,"<p>"),f.replace(/<\/p><\/p>/g,"</p>")):f.toggle("<p>","</p>")}},"quote-right":{title:n.quote,click:function(){f.toggle("<blockquote>","</blockquote>")}},header:{title:n.heading,click:function(){var a=f.selection(),b=/<h[1-6](>| .*?>)$/.exec(a.before);if(b=b?b[1]:">",m=6>m?m+1:0,a.value.length>0)if(a.before.match(/<h[1-6](>| .*?>)$/)){var c=a.before.replace(/<h[1-6](>| .*?>)$/,""),d=a.value.replace(/^<h[1-6](>| .*?>)|<\/h[1-6]>$/g,""),e=a.after.replace(/^<\/h[1-6]>/,"");f.area.value=c+(m>0?"<h"+m+b:"")+d+(m>0?"</h"+m+">":"")+e,f.select(c.length+(m>0?b.length+3:0),c.length+(m>0?b.length+3:0)+d.length,function(){f.updateHistory()})}else f.wrap(m>0?"<h"+m+b:"",m>0?"</h"+m+">":"",function(){f.replace(/^<h[1-6](>| .*?>)|<\/h[1-6]>$/g,"")});else{var g=k.placeholder.heading_text;m=1,f.insert("<h"+m+">"+g+"</h"+m+">",function(){a=f.selection().end,f.select(a-g.length-5,a-5,function(){f.updateHistory()})})}}},link:{title:n.link,click:function(){var b,d,a=f.selection(),e=k.placeholder.link_text;c.prompt(k.prompt.link_title_title,k.prompt.link_title,!1,function(g){b=g,c.prompt(k.prompt.link_url_title,k.prompt.link_url,!0,function(c){d=c,0===a.value.length?f.insert('<a href="'+d+'"'+(""!==b?' title="'+b+'"':"")+">"+e+"</a>",function(){var a=f.selection().end;f.select(a-e.length-4,a-4,function(){f.updateHistory()})}):f.wrap('<a href="'+d+'"'+(""!==b?' title="'+b+'"':"")+">","</a>")})})}},image:{title:n.image,click:function(){c.prompt(k.prompt.image_url_title,k.prompt.image_url,!0,function(a){var b=decodeURIComponent(a.substring(a.lastIndexOf("/")+1,a.lastIndexOf(".")).replace(/[\-\+\.\_]+/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()});b=-1===b.indexOf("/")&&-1!==a.indexOf(".")?b:k.placeholder.image_alt,f.insert('\n<img alt="'+b+'" src="'+a+'"'+k.emptyElementSuffix+"\n")})}},"list-ol":{title:n.ol,click:function(){var a=f.selection(),b=k.placeholder.list_ol_text;a.value.length>0?a.value==b?f.select(a.start,a.end):f.insert("<ol>\n"+k.tabSize+"<li>"+a.value.replace(/\n/g,"</li>\n"+k.tabSize+"<li>").replace(new RegExp("\n("+k.tabSize+")?<li></li>\n","g"),"\n</ol>\n\n<ol>\n")+"</li>\n</ol>"):f.insert("<ol>\n"+k.tabSize+"<li>"+b+"</li>\n</ol>",function(){f.select(a.start+k.tabSize.length+9,a.start+k.tabSize.length+9+b.length,function(){f.updateHistory()})})}},"list-ul":{title:n.ul,click:function(){var a=f.selection(),b=k.placeholder.list_ul_text;a.value.length>0?a.value==b?f.select(a.start,a.end):f.insert("<ul>\n"+k.tabSize+"<li>"+a.value.replace(/\n/g,"</li>\n"+k.tabSize+"<li>").replace(new RegExp("\n("+k.tabSize+")?<li></li>\n","g"),"\n</ul>\n\n<ul>\n")+"</li>\n</ul>"):f.insert("<ul>\n"+k.tabSize+"<li>"+b+"</li>\n</ul>",function(){f.select(a.start+k.tabSize.length+9,a.start+k.tabSize.length+9+b.length,function(){f.updateHistory()})})}},superscript:{title:n.superscript,click:function(){f.toggle("<sup>","</sup>")}},subscript:{title:n.subscript,click:function(){f.toggle("<sub>","</sub>")}},"ellipsis-h":{title:n.rule,click:function(){f.insert("\n<hr"+k.emptyElementSuffix+"\n")}},undo:{title:n.undo,click:function(){f.undo()}},repeat:{title:n.redo,click:function(){f.redo()}}};for(var p in o)c.button(p,o[p]);var q=function(a,b){return f.insert(a,function(){f.select(b.end+1,b.end+1)}),!1};f.area.onkeydown=function(a){var b=f.selection(),e=a.keyCode,h=a.ctrlKey,i=a.shiftKey,j=a.altKey;d.setTimeout(function(){k.keydown(a,c)},10);var l=b.before,m=b.after[0];if(-1!==l.indexOf("(")&&i&&48==e&&")"==m&&"\\"!=l.slice(-1)||-1!==l.indexOf("{")&&i&&221==e&&"}"==m&&"\\"!=l.slice(-1)||-1!==l.indexOf("[")&&221==e&&"]"==m&&"\\"!=l.slice(-1)||-1!==l.indexOf('"')&&i&&222==e&&'"'==m&&"\\"!=l.slice(-1)||-1!==l.indexOf("'")&&!i&&222==e&&"'"==m&&"\\"!=l.slice(-1)||-1!==l.indexOf("`")&&!i&&192==e&&"`"==m&&"\\"!=l.slice(-1)||-1!==l.indexOf("<")&&i&&190==e&&">"==m&&"\\"!=l.slice(-1))return f.select(b.end+1,b.end+1),!1;if(i&&57==e)return q("("+b.value+")",b);if(i&&219==e)return q("{"+b.value+"}",b);if(!i&&219==e)return q("["+b.value+"]",b);if(i&&222==e)return q('"'+b.value+'"',b);if(!i&&222==e)return q("'"+b.value+"'",b);if(!i&&192==e)return q("`"+b.value+"`",b);if(i&&188==e)return q("<"+b.value+">",b);if(i&&9==e)return f.outdent(k.tabSize),!1;if(9==e)return f.indent(k.tabSize),!1;if(h&&90==e)return f.undo(),!1;if(h&&89==e||h&&82==e)return f.redo(),!1;if(g.shortcut){if(h&&66==e)return o.bold.click(),!1;if(h&&73==e)return o.italic.click(),!1;if(h&&81==e)return o["quote-right"].click(),!1;if(j&&81==e)return i?f.toggle("&ldquo;","&rdquo;"):f.toggle("&lsquo;","&rsquo;"),!1;if(h&&72==e)return o.header.click(),!1;if(h&&76==e)return o.link.click(),!1;if(h&&71==e)return o.image.click(),!1}if(13==e){if(h)return o.paragraph.click(),!1;if(i)return f.insert("<br"+k.emptyElementSuffix+"\n"),!1;if(b.before.match(/<\/li>$/))return f.insert("\n"+k.tabSize+"<li></li>",function(){f.select(b.end+k.tabSize.length+5,b.end+k.tabSize.length+5,function(){f.updateHistory()})}),!1;if(b.after.match(/^<\/li>/))return f.insert("</li>\n"+k.tabSize+"<li>"),!1;var n=new RegExp("(^|\n)(("+k.tabSize+")+)(.*?)$").exec(b.before),p=n?n[2]:"";return b.before.match(/[\(\{\[]$/)&&b.after.match(/^[\]\}\)]/)||b.before.match(/<[^\/]*?>$/)&&b.after.match(/^<\//)?(f.insert("\n"+p+k.tabSize+"\n"+p,function(){f.select(b.start+p.length+k.tabSize.length+1,b.start+p.length+k.tabSize.length+1,function(){f.updateHistory()})}),!1):(f.insert("\n"+p),!1)}if(8==e&&0===b.value.length){if(b.before.match(new RegExp(k.tabSize+"$")))return f.outdent(k.tabSize),!1;switch(b.before.slice(-1)){case"(":return f.toggle("(",")"),!1;case"{":return f.toggle("{","}"),!1;case"[":return f.toggle("[","]"),!1;case'"':return f.toggle('"','"'),!1;case"'":return f.toggle("'","'"),!1;case"<":return f.toggle("<",">"),!1;case"`":return f.toggle("`","`"),!1}}if(39==e&&b.after.match(/^<\/.*?>/)){var r=b.end+b.after.indexOf(">");f.select(r,r,function(){f.updateHistory()})}f.updateHistory()},k.ready(c),c.grip=f,c.grip.config=k};