/*!
 * ----------------------------------------------------------
 *  HTML TEXT EDITOR PLUGIN 1.0.6
 * ----------------------------------------------------------
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 *
 * REQUIRES:
 * ==========================================================
 * [1]. https://github.com/tovic/simple-text-editor-library
 * [2]. https://fortawesome.github.io/Font-Awesome/icons
 * ==========================================================
 * ----------------------------------------------------------
 *
 */

var HTE=function(e,t){function n(e,t){e=e||{};for(var l in t)e[l]="object"==typeof t[l]?n(e[l],t[l]):t[l];return e}function l(e,t){var n=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),l=0;return l=d.defaultView&&d.defaultView.getComputedStyle?d.defaultView.getComputedStyle(e,null).getPropertyValue(t):e.style[n]}function i(e,t){return g.insert(e,function(){g.select(t.end+1)}),!1}function r(e){return e.replace(/^\s+|\s+$/g,"")}function o(e){return e.replace(/^\s+/,"")}function a(e){return e.replace(/\s+$/,"")}function c(e){return e.replace(g.escape,"\\$1")}function u(e){var t=new Date,n=""+t.getFullYear(),l=""+(t.getMonth()+1),i=""+t.getDate(),r=""+t.getHours(),o=""+t.getMinutes(),a=""+t.getSeconds(),c=""+t.getMilliseconds();10>l&&(l="0"+l),10>i&&(i="0"+i),10>r&&(r="0"+r),10>o&&(o="0"+o),10>a&&(a="0"+a),10>c&&(c="0"+c);var u={Y:n,m:l,d:i,H:r,i:o,s:a,u:c};return void 0!==e?u[e]:u}function s(e,t){var n,l=g.selection(),i=e,r=y.LI,o=i.split(" ")[0],a=r.split(" ")[0];l.value.length>0?l.value==t?g.select(l.start,l.end):g.insert("<"+i+">\n"+y.tabSize+"<"+r+">"+l.value.replace(/\n/g,"</"+a+">\n"+y.tabSize+"<"+r+">").replace(RegExp("\\n("+y.tabSize+")?<"+r+"><\\/"+a+">\\n","g"),"\n</"+o+">\n\n<"+i+">\n")+"</"+a+">\n</"+o+">"):g.insert("<"+i+">\n"+y.tabSize+"<"+r+">"+t+"</"+a+">\n</"+o+">",function(){n=l.start+1+i.length+2+y.tabSize.length+1+r.length+1,g.select(n,n+t.length,function(){g.updateHistory()})})}void 0!==t.prompt&&(t.prompts=t.prompt),void 0!==t.placeholder&&(t.placeholders=t.placeholder);var f=this,p=window,d=document,g=new Editor(e),h={tabSize:"    ",toolbar:!0,shortcut:!1,toolbarClass:"editor-toolbar",toolbarPosition:"before",buttonClassPrefix:"editor-toolbar-button editor-toolbar-button-",iconClassPrefix:"fa fa-",emptyElementSuffix:">",autoEncodeHTML:!0,P:"p",BR:"br",H_:"h%d",STRONG:"strong",EM:"em",U:"u",STRIKE:'del datetime="%Y-%m-%d"',UL:"ul",OL:"ol",LI:"li",HR:"hr",QUOTE:"q",BLOCKQUOTE:"blockquote",CODE:"code",PRE:"pre",SUB:"sub",SUP:"sup",A:"a",IMG:"img",buttons:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel",open:"Open",close:"Close",bold:"Bold",italic:"Italic",underline:"Underline",strike:"Strike",superscript:"Superscript",subscript:"Subscript",code:"Code",paragraph:"Paragraph",quote:"Quote",heading:"H1 \u2013 H6",link:"Link",image:"Image",ol:"Ordered List",ul:"Unordered List",rule:"Horizontal Rule",undo:"Undo",redo:"Redo"},prompts:{link_title:"link title goes here\u2026",link_title_title:"Link Title",link_url:"http://",link_url_title:"Link URL",image_url:"http://",image_url_title:"Image URL"},placeholders:{text:"text goes here\u2026",heading_text:"Heading",link_text:"link text",list_ul_text:"List Item",list_ol_text:"List Item",image_alt:"Image"},keydown:function(){},click:function(){},ready:function(){}},m=d.createElement("div"),v=d.createElement("div"),b=function(){};f.modal=function(e,t){e=e||"modal";var n=d.body,l=n.scrollTop||d.documentElement.scrollTop;m.className="custom-modal-overlay custom-modal-"+e+"-overlay",m.onclick=function(){f.close(!0)},v.className="custom-modal custom-modal-"+e,v.innerHTML='<div class="custom-modal-header custom-modal-'+e+'-header"></div><div class="custom-modal-content custom-modal-'+e+'-content"></div><div class="custom-modal-action custom-modal-'+e+'-action"></div>',v.style.visibility="hidden",n.appendChild(m),n.appendChild(v),p.setTimeout(function(){var e=v.offsetWidth,t=v.offsetHeight;v.style.position="absolute",v.style.top="50%",v.style.left="50%",v.style.zIndex="9999",v.style.marginTop=l-t/2+"px",v.style.marginLeft="-"+e/2+"px",v.style.visibility="",v.offsetTop<0&&(v.style.top=0,v.style.marginTop=0),v.offsetLeft<0&&(v.style.left=0,v.style.marginLeft=0)},10),"function"==typeof t&&t(m,v)},f.close=function(e){if(m&&d.body.removeChild(m),v&&d.body.removeChild(v),void 0!==e&&e===!0){var t=g.selection();g.select(t.start,t.end)}},f.prompt=function(e,t,n,l){f.modal("prompt",function(i,r){var o=function(e){"function"==typeof l?(f.close(),l(e)):f.close(!0)},a=d.createElement("input");a.type="text",a.value=t,a.onkeyup=function(e){n?13==e.keyCode&&""!==this.value&&this.value!==t&&o(this.value):13==e.keyCode&&o(this.value==t?"":this.value)};var c=d.createElement("button");c.innerHTML=y.buttons.ok,c.onclick=function(){n?""!==a.value&&a.value!==t&&o(a.value):o(a.value==t?"":a.value)};var u=d.createElement("button");u.innerHTML=y.buttons.cancel,u.onclick=function(){f.close(!0)},r.children[0].innerHTML=e?e:"",r.children[1].appendChild(a),r.children[2].appendChild(c),r.children[2].appendChild(d.createTextNode(" ")),r.children[2].appendChild(u),p.setTimeout(function(){a.select()},10)})},f.alert=function(e,t,n){f.modal("alert",function(l,i){var r=d.createElement("button");r.innerHTML=y.buttons.ok,r.onclick=function(){"function"==typeof n?(f.close(),n()):f.close(!0)},i.children[0].innerHTML=e?e:"",i.children[1].innerHTML=t?t:"",i.children[2].appendChild(r)})},f.confirm=function(e,t,n){f.modal("confirm",function(l,i){var r=d.createElement("button");r.innerHTML=y.buttons.ok,r.onclick=function(){void 0===n?f.close(!0):"function"==typeof n.OK?(f.close(),n.OK()):f.close(!0)};var o=d.createElement("button");o.innerHTML=y.buttons.cancel,o.onclick=function(){return void 0===n?f.close(!0):"function"==typeof n.CANCEL?(f.close(),n.CANCEL()):f.close(!0),!1},i.children[0].innerHTML=e?e:"",i.children[1].innerHTML=t?t:"",i.children[2].appendChild(r),i.children[2].appendChild(d.createTextNode(" ")),i.children[2].appendChild(o)})};var y=n(h,t),k=d.createElement("span"),x=c(y.tabSize),E=c(y.P.split(" ")[0]),H=c(y.LI.split(" ")[0]);y.toolbar&&(k.className=y.toolbarClass,g.area.parentNode.insertBefore(k,"before"==y.toolbarPosition?g.area:null));var T=d.createElement("a");T.href="#esc:"+(new Date).getTime(),T.style.width=0,T.style.height=0,g.area.parentNode.insertBefore(T,null),f.button=function(e,t){if(t.title!==!1){var n=d.createElement("a");n.className=y.buttonClassPrefix+e,n.href="#"+e.replace(" ",":").replace(/[^a-z0-9\:]/gi,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,""),n.setAttribute("tabindex",-1),n.innerHTML=t.text?t.text.replace(/%s/g,e):'<i class="'+y.iconClassPrefix+e+'"></i>',n.onclick=function(e){return t.click(e,f),y.click(e,f,this.hash.replace("#","")),!1},t.title&&(n.title=t.title),t.position?k.insertBefore(n,k.children[t.position-1]):k.appendChild(n)}},g.toggle=function(e,t,n){var l=g.selection();if(l.before.slice(-e.length)!=e&&l.after.slice(0,t.length)!=t)g.wrap(e,t);else{var i=l.before.slice(-e.length)==e?l.before.substring(0,l.before.length-e.length):l.before,r=l.after.substring(0,t.length)==t?l.after.substring(t.length):l.after;g.area.value=i+l.value+r,g.select(i.length,i.length+l.value.length,function(){g.updateHistory()})}"function"==typeof n&&n()};var _=0,C=y.buttons,L={bold:{title:C.bold,click:function(){var e=y.STRONG;g.toggle("<"+e+">","</"+e.split(" ")[0]+">")}},italic:{title:C.italic,click:function(){var e=y.EM;g.toggle("<"+e+">","</"+e.split(" ")[0]+">")}},underline:{title:C.underline,click:function(){var e=y.U;g.toggle("<"+e+">","</"+e.split(" ")[0]+">")}},strikethrough:{title:C.strike,click:function(){var e=u(),t=y.STRIKE;t=t.replace(/%Y/g,e.Y).replace(/%m/g,e.m).replace(/%d/g,e.d).replace(/%H/g,e.H).replace(/%i/g,e.i).replace(/%s/g,e.s).replace(/%u/g,e.u),g.toggle("<"+t+">","</"+t.split(" ")[0]+">")}},code:{title:C.code,click:function(){var e=g.selection().value,t=y.CODE,n=y.PRE,l=t.split(" ")[0],i=n.split(" ")[0],r=-1===e.indexOf("\n"),o=r?"<"+t+">":"<"+n+"><"+t+">",a=r?"</"+l+">":"</"+l+"></"+i+">";if(e.length>0){var u=g.selection(),s=u.before,f=u.after,p=u.value,d=c(l),h=c(i);s.match(RegExp("(<"+h+"(>| .*?>))?<"+d+"(>| .*?>)$"))&&f.match(RegExp("^<\\/"+d+">(<\\/"+h+">)?"))?(s=s.replace(RegExp("(<"+h+"(>| .*?>))?<"+d+"(>| .*?>)$"),""),f=f.replace(RegExp("^<\\/"+d+">(<\\/"+h+">)?"),""),y.autoEncodeHTML&&(p=p.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")),g.area.value=s+p+f,g.select(s.length,s.length+p.length,function(){g.updateHistory()})):(y.autoEncodeHTML&&(p=p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),g.area.value=s+o+p+a+f,g.select(s.length+o.length,s.length+p.length+o.length,function(){g.updateHistory()}))}else g.toggle(o,a)}},paragraph:{title:C.paragraph,click:function(){var e=g.selection().value,t=y.P,n=t.split(" ")[0],l=c(n);e.length>0?RegExp("^<"+l+"(>| .*?>)|<\\/"+l+">$").test(e)?g.replace(RegExp("<"+l+"(>| .*?>)([\\s\\S]*?)<\\/"+l+">","g"),"$2"):(g.replace(/^/,"<"+t+">",b),g.replace(/$/,"</"+n+">",b),g.replace(/\n/g,"</"+n+">\n<"+t+">",b),g.replace(RegExp("<"+n+"(>| .*?>)<\\/"+n+">","g"),"",b),g.replace(RegExp("(<"+n+"(>| .*?>))+","g"),"$1",b),g.replace(RegExp("(<\\/"+n+">)+","g"),"$1")):g.toggle("<"+t+">","</"+n+">")}},"quote-right":{title:C.quote,click:function(){var e=g.selection(),t=y.QUOTE,n=y.BLOCKQUOTE;0===e.start||e.before.match(/\n$/)?g.toggle("<"+n+">","</"+n.split(" ")[0]+">"):e.before.match(RegExp("<"+n.split(" ")[0]+"(>| .*?>)$"))?g.toggle("<"+n+">","</"+n.split(" ")[0]+">"):g.toggle("<"+t+">","</"+t.split(" ")[0]+">")}},header:{title:C.heading,click:function(){var e,t=g.selection(),n=y.H_,l=n.split(" ")[0],i=c(l).replace(/%d/g,"[1-6]"),u=y.P,s=u.split(" ")[0],f=c(s),p="<\\/?(?:"+i+"|"+f+")(>| .*?>)",d=a(t.before.replace(RegExp(p+"$"),"")).length>0?"\n\n":"",h=t.value.match(RegExp("^"+p))?RegExp("^"+p).exec(t.value):RegExp(p+"$").exec(t.before);if(h=h?h[1]:">",_=6>_?_+1:0,t.value.length>0)if(t.before.match(RegExp(p+"$"))){var m=a(t.before.replace(RegExp(p+"$","g"),"")),v=r(t.value.replace(RegExp("^"+p+"|"+p+"$","g"),"").replace(/\n+/g," ")),k=o(t.after.replace(RegExp("^"+p,"g"),"")),x=l.replace(/%d/g,_);g.area.value=m+d+"<"+(_>0?x:s)+h+v+"</"+(_>0?x:s)+">\n\n"+k,e=m.length+d.length+1+(_>0?x.length:s.length)+h.length,g.select(e,e+v.length,function(){g.updateHistory()})}else g.wrap("<"+(_>0?n.replace(/%d/g,_):u)+h,"</"+(_>0?l.replace(/%d/g,_):s)+">",function(){g.replace(RegExp("^"+p+"|"+p+"$","g"),"",b),g.replace(/\n+/g," ")});else{var E=y.placeholders.heading_text;n=n.replace(/%d/g,1),l=l.replace(/%d/g,1),_=1,g.area.value=a(t.before)+d+"<"+n+">"+E+"</"+l+">\n\n"+o(t.after),e=t.before.length+d.length+1+n.length+1,g.select(e,e+E.length,function(){g.updateHistory()})}}},link:{title:C.link,click:function(){var e,t,n,l=g.selection(),i=y.A,r=i.split(" ")[0],o=y.placeholders.link_text;f.prompt(y.prompts.link_title_title,y.prompts.link_title,!1,function(a){e=a,f.prompt(y.prompts.link_url_title,y.prompts.link_url,!0,function(a){t=a,0===l.value.length?g.insert("<"+i+' href="'+t+'"'+(""!==e?' title="'+e+'"':"")+">"+o+"</"+r+">",function(){n=g.selection().end,g.select(n-o.length-(r.length+3),n-(r.length+3),function(){g.updateHistory()})}):g.wrap("<"+i+' href="'+t+'"'+(""!==e?' title="'+e+'"':"")+">","</"+r+">")})})}},image:{title:C.image,click:function(){f.prompt(y.prompts.image_url_title,y.prompts.image_url,!0,function(e){var t,n=g.selection(),l=a(n.before),i=o(n.after),r=l.length>0?"\n\n":"",c=y.emptyElementSuffix,u=decodeURIComponent(e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")).replace(/[-+._]+/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()});u=-1===u.indexOf("/")&&-1!==e.indexOf(".")?u:y.placeholders.image_alt,g.area.value=l+r+"<"+y.IMG+' alt="'+u+'" src="'+e+'"'+c+"\n\n"+i,t=l.length+r.length+1+y.IMG.length+6+u.length+7+e.length+1+c.length+2,g.select(t,function(){g.updateHistory()})})}},"list-ol":{title:C.ol,click:function(){s(y.OL,y.placeholders.list_ol_text)}},"list-ul":{title:C.ul,click:function(){s(y.UL,y.placeholders.list_ul_text)}},superscript:{title:C.superscript,click:function(){var e=y.SUP;g.toggle("<"+e+">","</"+e.split(" ")[0]+">")}},subscript:{title:C.subscript,click:function(){var e=y.SUB;g.toggle("<"+e+">","</"+e.split(" ")[0]+">")}},"ellipsis-h":{title:C.rule,click:function(){var e=g.selection(),t=a(e.before),n=o(e.after),l=t.length>0?"\n\n":"",i=y.HR,r=y.emptyElementSuffix;g.area.value=t+l+"<"+i+r+"\n\n"+n,g.select(t.length+l.length+1+i.length+r.length+2,function(){g.updateHistory()})}},undo:{title:C.undo,click:function(){g.undo()}},repeat:{title:C.redo,click:function(){g.redo()}}};for(var R in L)f.button(R,L[R]);g.area.oncut=function(){p.setTimeout(function(){g.updateHistory()},1)},g.area.onpaste=function(){p.setTimeout(function(){g.updateHistory()},1)},g.area.onkeydown=function(e){var t=this,n=g.selection(),r=e.keyCode,o=e.ctrlKey,a=e.shiftKey,c=e.altKey,u=t.scrollTop+parseInt(l(t,"line-height"),10);p.setTimeout(function(){y.keydown(e,f)},10);var s=n.before,d=n.after[0],h="\\"==s.slice(-1);if(-1!==s.indexOf("(")&&a&&48==r&&")"==d&&!h||-1!==s.indexOf("{")&&a&&221==r&&"}"==d&&!h||-1!==s.indexOf("[")&&221==r&&"]"==d&&!h||-1!==s.indexOf('"')&&a&&222==r&&'"'==d&&!h||-1!==s.indexOf("'")&&!a&&222==r&&"'"==d&&!h||-1!==s.indexOf("`")&&!a&&192==r&&"`"==d&&!h||-1!==s.indexOf("<")&&a&&190==r&&">"==d&&!h)return g.select(n.end+1),!1;if(a&&57==r&&!h)return i("("+n.value+")",n);if(a&&219==r&&!h)return i("{"+n.value+"}",n);if(!a&&219==r&&!h)return i("["+n.value+"]",n);if(a&&222==r&&!h)return i('"'+n.value+'"',n);if(!a&&222==r&&!h)return i("'"+n.value+"'",n);if(!a&&192==r&&!h)return i("`"+n.value+"`",n);if(a&&188==r&&!h)return i("<"+n.value+">",n);if(a&&9==r)return g.outdent(y.tabSize),!1;if(9==r){if(n.before.match(/<[^\/>]*?$/)&&">"==n.after[0]){var m=/<([^\/>]*?)$/.exec(n.before);return t.value=n.before+" "+n.value+"></"+m[1].split(" ")[0]+n.after,g.select(n.start+1,function(){g.updateHistory()}),!1}return g.indent(y.tabSize),!1}if(o&&90==r)return g.undo(),!1;if(o&&89==r||o&&82==r)return g.redo(),!1;if(y.shortcut){if(o&&66==r)return L.bold.click(),!1;if(o&&73==r)return L.italic.click(),!1;if(o&&81==r)return L["quote-right"].click(),!1;if(a&&81==r&&n.value.length>0)return c?g.toggle("\u2018","\u2019"):g.toggle("\u201C","\u201D"),!1;if(o&&72==r)return L.header.click(),!1;if(o&&76==r)return L.link.click(),!1;if(o&&71==r)return L.image.click(),!1}if(13==r){if(o)return L.paragraph.click(),!1;if(a)return g.insert("<"+y.BR+y.emptyElementSuffix+"\n"),t.scrollTop=u,!1;var v=y.LI.split(" ")[0];if(n.before.match(RegExp("<\\/"+H+">$"))){var m=RegExp("(?:^|\\n)([\\t ]*)<"+H+"(>| .*?>).*?<\\/"+H+">$").exec(n.before);return g.insert("\n"+m[1]+"<"+v+m[2]+"</"+v+">",function(){g.select(n.end+m[1].length+m[2].length+4,function(){g.updateHistory()})}),t.scrollTop=u,!1}if(n.after.match(RegExp("^<\\/"+H+">"))&&">"!=n.before.slice(-1)){var m=RegExp("(?:^|\\n)([\\t ]*)<"+H+"(>| .*?>).*$").exec(n.before);return g.insert("</"+v+">\n"+m[1]+"<"+v+m[2]),t.scrollTop=u,!1}var b=y.P.split(" ")[0];if(n.after.match(RegExp("^<\\/"+E+">"))){var m=RegExp("(?:^|\\n)([\\t ]*)<"+E+"(>| .*?>).*$").exec(n.before);return g.insert("</"+b+">\n"+m[1]+"<"+b+m[2]),t.scrollTop=u,!1}var k=RegExp("(?:^|\\n)(("+x+")+)(.*?)$").exec(n.before),_=k?k[1]:"";return n.before.match(/[\(\{\[]$/)&&n.after.match(/^[\]\}\)]/)||n.before.match(/<[^\/>]*?>$/)&&n.after.match(/^<\//)?(g.insert("\n"+_+y.tabSize+"\n"+_,function(){g.select(n.start+_.length+y.tabSize.length+1,function(){g.updateHistory()})}),t.scrollTop=u,!1):(g.insert("\n"+_),t.scrollTop=u,!1)}if(8==r&&0===n.value.length){if(n.before.match(RegExp(x+"$")))return g.outdent(y.tabSize),!1;if(n.before.match(/<\/?[^>]*?>$/))return g.outdent("</?[^>]*?>",1,!0),!1;switch(n.before.slice(-1)){case"(":return g.toggle("(",")"),!1;case"{":return g.toggle("{","}"),!1;case"[":return g.toggle("[","]"),!1;case'"':return g.toggle('"','"'),!1;case"'":return g.toggle("'","'"),!1;case"<":return g.toggle("<",">"),!1;case"`":return g.toggle("`","`"),!1}}if(39==r&&n.after.match(/^<\/.*?>/)){var C=n.end+n.after.indexOf(">")+1;return g.select(C),!1}return 27==r?(T.focus(),!1):void(c||o||a||p.setTimeout(function(){g.updateHistory()},1))},y.ready(f),f.grip=g,f.grip.config=y};