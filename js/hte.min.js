/*!
 * ----------------------------------------------------------
 *  HTML TEXT EDITOR PLUGIN 1.0.8
 * ----------------------------------------------------------
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 *
 * REQUIRES:
 * ==========================================================
 * [1]. https://github.com/tovic/simple-text-editor-library
 * [2]. https://fortawesome.github.io/Font-Awesome/icons
 * ==========================================================
 * ----------------------------------------------------------
 *
 */

var HTE=function(e,t){function n(e,t){e=e||{};for(var l in t)e[l]="object"==typeof t[l]?n(e[l],t[l]):t[l];return e}function l(e,t){var n=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),l=0;return l=p.defaultView&&p.defaultView.getComputedStyle?p.defaultView.getComputedStyle(e,null).getPropertyValue(t):e.style[n]}function i(e,t){return d.insert(e,function(){d.select(t.end+1)}),!1}function r(e){return e.replace(/^\s+|\s+$/g,"")}function o(e){return e.replace(/^\s+/,"")}function a(e){return e.replace(/\s+$/,"")}function c(e){return e.replace(d.escape,"\\$1")}function u(e,t){var n,l=d.selection(),i=e,r=b.LI,o=i.split(" ")[0],a=r.split(" ")[0];l.value.length>0?l.value==t?d.select(l.start,l.end):d.insert("<"+i+">\n"+b.tabSize+"<"+r+">"+l.value.replace(/\n/g,"</"+a+">\n"+b.tabSize+"<"+r+">").replace(RegExp("\\n("+b.tabSize+")?<"+r+"><\\/"+a+">\\n","g"),"\n</"+o+">\n\n<"+i+">\n")+"</"+a+">\n</"+o+">"):d.insert("<"+i+">\n"+b.tabSize+"<"+r+">"+t+"</"+a+">\n</"+o+">",function(){n=l.start+1+i.length+2+b.tabSize.length+1+r.length+1,d.select(n,n+t.length,function(){d.updateHistory()})})}void 0!==t.prompt&&(t.prompts=t.prompt),void 0!==t.placeholder&&(t.placeholders=t.placeholder);var s=this,f=window,p=document,d=new Editor(e),g={tabSize:"    ",toolbar:!0,shortcut:!1,toolbarClass:"editor-toolbar",toolbarPosition:"before",buttonClassPrefix:"editor-toolbar-button editor-toolbar-button-",iconClassPrefix:"fa fa-",emptyElementSuffix:">",autoEncodeHTML:!0,P:"p",BR:"br",H_:"h%d",STRONG:"strong",EM:"em",U:"u",STRIKE:'del datetime="%Y-%m-%d"',UL:"ul",OL:"ol",LI:"li",HR:"hr",QUOTE:"q",BLOCKQUOTE:"blockquote",CODE:"code",PRE:"pre",SUB:"sub",SUP:"sup",A:"a",IMG:"img",buttons:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel",open:"Open",close:"Close",bold:"Bold",italic:"Italic",underline:"Underline",strike:"Strike",superscript:"Superscript",subscript:"Subscript",code:"Code",paragraph:"Paragraph",quote:"Quote",heading:"H1 \u2013 H6",link:"Link",image:"Image",ol:"Ordered List",ul:"Unordered List",rule:"Horizontal Rule",undo:"Undo",redo:"Redo"},prompts:{link_title:"link title goes here\u2026",link_title_title:"Link Title",link_url:"http://",link_url_title:"Link URL",image_url:"http://",image_url_title:"Image URL"},placeholders:{text:"text goes here\u2026",heading_text:"Heading",link_text:"link text",list_ul_text:"List Item",list_ol_text:"List Item",image_alt:"Image"},keydown:function(){},click:function(){},ready:function(){}},h=p.createElement("div"),m=p.createElement("div"),v=function(){},b=n(g,t),y=p.createElement("span"),x=c(b.tabSize),k=c(b.P.split(" ")[0]),E=c(b.LI.split(" ")[0]);s.modal=function(e,t){e=e||"modal";var n=p.body,l=n.scrollTop||p.documentElement.scrollTop;h.className="custom-modal-overlay custom-modal-"+e+"-overlay",h.onclick=function(){s.close(!0)},m.className="custom-modal custom-modal-"+e,m.innerHTML='<div class="custom-modal-header custom-modal-'+e+'-header"></div><div class="custom-modal-content custom-modal-'+e+'-content"></div><div class="custom-modal-action custom-modal-'+e+'-action"></div>',m.style.visibility="hidden",n.appendChild(h),n.appendChild(m),f.setTimeout(function(){var e=m.offsetWidth,t=m.offsetHeight;m.style.position="absolute",m.style.top="50%",m.style.left="50%",m.style.zIndex="9999",m.style.marginTop=l-t/2+"px",m.style.marginLeft=0-e/2+"px",m.style.visibility="",m.offsetTop<0&&(m.style.top=0,m.style.marginTop=0),m.offsetLeft<0&&(m.style.left=0,m.style.marginLeft=0)},10),"function"==typeof t&&t(h,m)},s.close=function(e){if(h&&p.body.removeChild(h),m&&p.body.removeChild(m),e&&e!==!1){var t=d.selection();d.select(t.start,t.end)}},s.prompt=function(e,t,n,l){s.modal("prompt",function(i,r){var o=function(e){"function"==typeof l?(s.close(),l(e)):s.close(!0)},a=p.createElement("input");a.type="text",a.value=t,a.onkeyup=function(e){n?13==e.keyCode&&""!==this.value&&this.value!==t&&o(this.value):13==e.keyCode&&o(this.value==t?"":this.value)};var c=p.createElement("button");c.innerHTML=b.buttons.ok,c.onclick=function(){n?""!==a.value&&a.value!==t&&o(a.value):o(a.value==t?"":a.value)};var u=p.createElement("button");u.innerHTML=b.buttons.cancel,u.onclick=function(){s.close(!0)},r.children[0].innerHTML=e?e:"",r.children[1].appendChild(a),r.children[2].appendChild(c),r.children[2].appendChild(p.createTextNode(" ")),r.children[2].appendChild(u),f.setTimeout(function(){a.select()},10)})},s.alert=function(e,t,n){s.modal("alert",function(l,i){var r=p.createElement("button");r.innerHTML=b.buttons.ok,r.onclick=function(){"function"==typeof n?(s.close(),n()):s.close(!0)},i.children[0].innerHTML=e?e:"",i.children[1].innerHTML=t?t:"",i.children[2].appendChild(r)})},s.confirm=function(e,t,n){s.modal("confirm",function(l,i){var r=p.createElement("button");r.innerHTML=b.buttons.ok,r.onclick=function(){void 0===n?s.close(!0):"function"==typeof n.OK?(s.close(),n.OK()):s.close(!0)};var o=p.createElement("button");o.innerHTML=b.buttons.cancel,o.onclick=function(){return void 0===n?s.close(!0):"function"==typeof n.CANCEL?(s.close(),n.CANCEL()):s.close(!0),!1},i.children[0].innerHTML=e?e:"",i.children[1].innerHTML=t?t:"",i.children[2].appendChild(r),i.children[2].appendChild(p.createTextNode(" ")),i.children[2].appendChild(o)})},s.scroll=function(e,t){var n=d.area;"number"==typeof e?n.scrollTop=e:n.scrollTop+=parseInt(l(n,"line-height"),10),"function"==typeof t&&t()},s.time=function(e){var t=new Date,n=t.getFullYear(),l=t.getMonth()+1,i=t.getDate(),r=t.getHours(),o=t.getMinutes(),a=t.getSeconds(),c=t.getMilliseconds();10>l&&(l="0"+l),10>i&&(i="0"+i),10>r&&(r="0"+r),10>o&&(o="0"+o),10>a&&(a="0"+a),10>c&&(c="0"+c);var u={Y:""+n,m:""+l,d:""+i,H:""+r,i:""+o,s:""+a,u:""+c};return void 0!==e?u[e]:u},b.toolbar&&(y.className=b.toolbarClass,d.area.parentNode.insertBefore(y,"before"==b.toolbarPosition?d.area:null));var H=p.createElement("a");H.href="#esc:"+(new Date).getTime(),H.style.width=0,H.style.height=0,d.area.parentNode.appendChild(H),s.button=function(e,t){if(t.title!==!1){var n=p.createElement("a");if(n.className=b.buttonClassPrefix+e,n.href="#"+e.replace(" ",":").replace(/[^a-z0-9\:]/gi,"-").replace(/-+/g,"-").replace(/^-+|-+$/g,""),n.setAttribute("tabindex",-1),n.innerHTML=t.text?t.text.replace(/%s/g,e):'<i class="'+b.iconClassPrefix+e+'"></i>',n.onclick=function(e){return t.click(e,s),b.click(e,s,this.hash.replace("#","")),!1},t.title&&(n.title=t.title),t.position){var l=t.position<0?t.position+y.children.length+1:t.position-1;y.insertBefore(n,y.children[l])}else y.appendChild(n)}},d.toggle=function(e,t,n,l){var i=d.selection();if(i.before.slice(-e.length)!=e&&i.after.slice(0,t.length)!=t)d.wrap(e,t,0===i.value.length&&l?function(){d.replace(/^.*$/,l===!0?b.placeholders.text:l)}:1);else{var r=i.before.slice(-e.length)==e?i.before.substring(0,i.before.length-e.length):i.before,o=i.after.substring(0,t.length)==t?i.after.substring(t.length):i.after;d.area.value=r+i.value+o,d.select(r.length,r.length+i.value.length,function(){d.updateHistory()})}"function"==typeof n&&n()};var C=0,_=b.buttons,L={bold:{title:_.bold,click:function(){var e=b.STRONG;d.toggle("<"+e+">","</"+e.split(" ")[0]+">",1,!0)}},italic:{title:_.italic,click:function(){var e=b.EM;d.toggle("<"+e+">","</"+e.split(" ")[0]+">",1,!0)}},underline:{title:_.underline,click:function(){var e=b.U;d.toggle("<"+e+">","</"+e.split(" ")[0]+">",1,!0)}},strikethrough:{title:_.strike,click:function(){var e=s.time(),t=b.STRIKE;t=t.replace(/%Y/g,e.Y).replace(/%m/g,e.m).replace(/%d/g,e.d).replace(/%H/g,e.H).replace(/%i/g,e.i).replace(/%s/g,e.s).replace(/%u/g,e.u),d.toggle("<"+t+">","</"+t.split(" ")[0]+">",1,!0)}},code:{title:_.code,click:function(){var e=d.selection().value,t=b.CODE,n=b.PRE,l=t.split(" ")[0],i=n.split(" ")[0],r=-1===e.indexOf("\n"),o=r?"<"+t+">":"<"+n+"><"+t+">",a=r?"</"+l+">":"</"+l+"></"+i+">";if(e.length>0){var u=d.selection(),s=u.before,f=u.after,p=u.value,g=c(l),h=c(i);s.match(RegExp("(<"+h+"(>| .*?>))?<"+g+"(>| .*?>)$"))&&f.match(RegExp("^<\\/"+g+">(<\\/"+h+">)?"))?(s=s.replace(RegExp("(<"+h+"(>| .*?>))?<"+g+"(>| .*?>)$"),""),f=f.replace(RegExp("^<\\/"+g+">(<\\/"+h+">)?"),""),b.autoEncodeHTML&&(p=p.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")),d.area.value=s+p+f,d.select(s.length,s.length+p.length,function(){d.updateHistory()})):(b.autoEncodeHTML&&(p=p.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),d.area.value=s+o+p+a+f,d.select(s.length+o.length,s.length+p.length+o.length,function(){d.updateHistory()}))}else d.toggle(o,a,1,!0)}},paragraph:{title:_.paragraph,click:function(){var e=d.selection().value,t=b.P,n=t.split(" ")[0],l=c(n);e.length>0?RegExp("^<"+l+"(>| .*?>)|<\\/"+l+">$").test(e)?d.replace(RegExp("<"+l+"(>| .*?>)([\\s\\S]*?)<\\/"+l+">","g"),"$2"):(d.replace(/^/,"<"+t+">",v),d.replace(/$/,"</"+n+">",v),d.replace(/\n/g,"</"+n+">\n<"+t+">",v),d.replace(RegExp("<"+n+"(>| .*?>)<\\/"+n+">","g"),"",v),d.replace(RegExp("(<"+n+"(>| .*?>))+","g"),"$1",v),d.replace(RegExp("(<\\/"+n+">)+","g"),"$1")):d.toggle("<"+t+">","</"+n+">")}},"quote-right":{title:_.quote,click:function(){var e=d.selection(),t=b.QUOTE,n=b.BLOCKQUOTE;0===e.start||e.before.match(/\n$/)?d.toggle("<"+n+">","</"+n.split(" ")[0]+">",1,!0):e.before.match(RegExp("<"+n.split(" ")[0]+"(>| .*?>)$"))?d.toggle("<"+n+">","</"+n.split(" ")[0]+">",1,!0):d.toggle("<"+t+">","</"+t.split(" ")[0]+">",1,!0)}},header:{title:_.heading,click:function(){var e,t,n,l=d.selection(),i=b.H_,u=i.split(" ")[0],s=c(u).replace(/%d/g,"[1-6]"),f=b.P,p=f.split(" ")[0],g=c(p),h="<\\/?(?:"+s+"|"+g+")(>| .*?>)",m=a(l.before.replace(RegExp(h+"$"),"")).length>0?"\n\n":"",v=a(l.before.replace(RegExp(h+"$","g"),"")),y=r(l.value.replace(RegExp("^"+h+"|"+h+"$","g"),"").replace(/\n+/g," ")),x=o(l.after.replace(RegExp("^"+h,"g"),"")),k=l.value.match(RegExp("^"+h))?RegExp("^"+h).exec(l.value):RegExp(h+"$").exec(l.before);if(k=k?k[1]:">",C=6>C?C+1:0,l.value.length>0)l.before.match(RegExp(h+"$"))?(n=u.replace(/%d/g,C),d.area.value=v+m+"<"+(C>0?n:p)+k+y+"</"+(C>0?n:p)+">\n\n"+x,e=v.length+m.length+1+(C>0?n.length:p.length)+k.length):(t=i.replace(/%d/g,C),n=u.replace(/%d/g,C),d.area.value=v+m+"<"+(C>0?t:f)+k+y+"</"+(C>0?n:p)+">\n\n"+x,e=v.length+m.length+1+(C>0?t.length:f.length)+k.length),d.select(e,e+y.length,function(){d.updateHistory()});else{var E=b.placeholders.heading_text;i=i.replace(/%d/g,1),u=u.replace(/%d/g,1),C=1,d.area.value=a(l.before)+m+"<"+i+">"+E+"</"+u+">\n\n"+o(l.after),e=a(l.before).length+m.length+1+i.length+1,d.select(e,e+E.length,function(){d.updateHistory()})}}},link:{title:_.link,click:function(){var e,t,n=d.selection(),l=b.A,i=l.split(" ")[0],r=b.placeholders.link_text;s.prompt(b.prompts.link_url_title,b.prompts.link_url,!0,function(o){t=o,s.prompt(b.prompts.link_title_title,b.prompts.link_title,!1,function(o){e=o,d.wrap("<"+l+' href="'+t+'"'+(""!==e?' title="'+e+'"':"")+">","</"+i+">",0===n.value.length?function(){d.replace(/^/,r)}:1)})})}},image:{title:_.image,click:function(){s.prompt(b.prompts.image_url_title,b.prompts.image_url,!0,function(e){var t=d.selection(),n=a(t.before),l=o(t.after),i=n.length>0?"\n\n":"",r=b.emptyElementSuffix,c=decodeURIComponent(e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")).replace(/[-+._]+/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()});c=-1===c.indexOf("/")&&-1!==e.indexOf(".")?c:b.placeholders.image_alt,d.area.value=n+i+"<"+b.IMG+' alt="'+c+'" src="'+e+'"'+r+"\n\n"+l,d.select(n.length+i.length+1+b.IMG.length+6+c.length+7+e.length+1+r.length+2,function(){d.updateHistory()})})}},"list-ol":{title:_.ol,click:function(){u(b.OL,b.placeholders.list_ol_text)}},"list-ul":{title:_.ul,click:function(){u(b.UL,b.placeholders.list_ul_text)}},superscript:{title:_.superscript,click:function(){var e=b.SUP;d.toggle("<"+e+">","</"+e.split(" ")[0]+">",1,!0)}},subscript:{title:_.subscript,click:function(){var e=b.SUB;d.toggle("<"+e+">","</"+e.split(" ")[0]+">",1,!0)}},"ellipsis-h":{title:_.rule,click:function(){var e=d.selection(),t=a(e.before),n=o(e.after),l=t.length>0?"\n\n":"",i=b.HR,r=b.emptyElementSuffix;d.area.value=t+l+"<"+i+r+"\n\n"+n,d.select(t.length+l.length+1+i.length+r.length+2,function(){d.updateHistory()})}},undo:{title:_.undo,click:function(){d.undo()}},repeat:{title:_.redo,click:function(){d.redo()}}};for(var T in L)s.button(T,L[T]);d.area.oncut=function(){f.setTimeout(function(){d.updateHistory()},1)},d.area.onpaste=function(){f.setTimeout(function(){d.updateHistory()},1)},d.area.onkeydown=function(e){var t=this,n=d.selection(),l=e.keyCode,r=e.ctrlKey,o=e.shiftKey,a=e.altKey;f.setTimeout(function(){b.keydown(e,s)},10);var c=n.before,u=n.after[0],p="\\"==c.slice(-1);if(-1!==c.indexOf("(")&&o&&48==l&&")"==u&&!p||-1!==c.indexOf("{")&&o&&221==l&&"}"==u&&!p||-1!==c.indexOf("[")&&221==l&&"]"==u&&!p||-1!==c.indexOf('"')&&o&&222==l&&'"'==u&&!p||-1!==c.indexOf("'")&&!o&&222==l&&"'"==u&&!p||-1!==c.indexOf("`")&&!o&&192==l&&"`"==u&&!p||-1!==c.indexOf("<")&&o&&190==l&&">"==u&&!p)return d.select(n.end+1),!1;if(o&&57==l&&!p)return i("("+n.value+")",n);if(o&&219==l&&!p)return i("{"+n.value+"}",n);if(!o&&219==l&&!p)return i("["+n.value+"]",n);if(o&&222==l&&!p)return i('"'+n.value+'"',n);if(!o&&222==l&&!p)return i("'"+n.value+"'",n);if(!o&&192==l&&!p)return i("`"+n.value+"`",n);if(o&&188==l&&!p)return i("<"+n.value+">",n);if(o&&9==l)return d.outdent(b.tabSize),!1;if(9==l){if(n.before.match(/<[^\/>]*?$/)&&">"==n.after[0]){var g=/<([^\/>]*?)$/.exec(n.before);return t.value=n.before+" "+n.value+"></"+g[1].split(" ")[0]+n.after,d.select(n.start+1,function(){d.updateHistory()}),!1}return d.indent(b.tabSize),!1}if(r&&90==l)return d.undo(),!1;if(r&&89==l||r&&82==l)return d.redo(),!1;if(b.shortcut){if(r&&66==l)return L.bold.click(),!1;if(r&&73==l)return L.italic.click(),!1;if(r&&81==l)return L["quote-right"].click(),!1;if(o&&81==l&&n.value.length>0)return a?d.toggle("\u2018","\u2019"):d.toggle("\u201C","\u201D"),!1;if(r&&72==l)return L.header.click(),!1;if(r&&76==l)return L.link.click(),!1;if(r&&71==l)return L.image.click(),!1}if(13==l){if(r)return L.paragraph.click(),!1;if(o)return d.insert("<"+b.BR+b.emptyElementSuffix+"\n"),s.scroll(),!1;var h=b.LI.split(" ")[0];if(n.before.match(RegExp("<\\/"+E+">$"))){var g=RegExp("(?:^|\\n)([\\t ]*)<"+E+"(>| .*?>).*?<\\/"+E+">$").exec(n.before);return d.insert("\n"+g[1]+"<"+h+g[2]+"</"+h+">",function(){d.select(n.end+g[1].length+g[2].length+4,function(){d.updateHistory()})}),s.scroll(),!1}if(n.after.match(RegExp("^<\\/"+E+">"))&&">"!=n.before.slice(-1)){var g=RegExp("(?:^|\\n)([\\t ]*)<"+E+"(>| .*?>).*$").exec(n.before);return d.insert("</"+h+">\n"+g[1]+"<"+h+g[2]),s.scroll(),!1}var m=b.P.split(" ")[0];if(n.after.match(RegExp("^<\\/"+k+">"))){var g=RegExp("(?:^|\\n?)([\\t ]*)<"+k+"(>| .*?>).*$").exec(n.before);return d.insert("</"+m+">\n"+g[1]+"<"+m+g[2]),s.scroll(),!1}var v=RegExp("(?:^|\\n)(("+x+")+)(.*?)$").exec(n.before),y=v?v[1]:"";return n.before.match(/[\(\{\[]$/)&&n.after.match(/^[\]\}\)]/)||n.before.match(/<[^\/>]*?>$/)&&n.after.match(/^<\//)?(d.insert("\n"+y+b.tabSize+"\n"+y,function(){d.select(n.start+y.length+b.tabSize.length+1,function(){d.updateHistory()})}),s.scroll(),!1):(d.insert("\n"+y),s.scroll(),!1)}if(8==l&&0===n.value.length){if(n.before.match(RegExp(x+"$")))return d.outdent(b.tabSize),!1;if(n.before.match(/<\/?[^>]*?>$/))return d.outdent("</?[^>]*?>",1,!0),!1;switch(n.before.slice(-1)){case"(":return d.toggle("(",")"),!1;case"{":return d.toggle("{","}"),!1;case"[":return d.toggle("[","]"),!1;case'"':return d.toggle('"','"'),!1;case"'":return d.toggle("'","'"),!1;case"<":return d.toggle("<",">"),!1;case"`":return d.toggle("`","`"),!1}}if(39==l&&n.after.match(/^<\/.*?>/)){var C=n.end+n.after.indexOf(">")+1;return d.select(C),!1}return 27==l?(H.focus(),!1):void(a||r||o||f.setTimeout(function(){d.updateHistory()},1))},b.ready(s),s.grip=d,s.grip.config=b};